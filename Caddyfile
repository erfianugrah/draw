{
    email {$EMAIL}
}

{$DOMAIN} {
    tls {
        dns cloudflare {$CF_API_TOKEN}
    }

    # Storage API
    handle_path /api/* {
        reverse_proxy excalidraw-storage:3003
    }

    # Socket.io for collaboration (WebSocket + polling)
    handle /socket.io/* {
        reverse_proxy excalidraw-room:3002
    }

    # Static files - Excalidraw frontend
    handle {
        root * /srv
        encode gzip
        try_files {path} /index.html
        file_server
    }
}
